<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="My personal site, a web blog about software development, functional programming, and programming languages.">

    <meta data-react-helmet="true" property="og:title" content="Migrating my blog to Pollen">
    <meta data-react-helmet="true" property="og:description" content="My personal site, a web blog about software development, functional programming, and programming languages.">
    <meta data-react-helmet="true" property="og:type" content="website">

    <meta data-react-helmet="true" name="twitter:card" content="summary">
    <meta data-react-helmet="true" name="twitter:title" content="Migrating my blog to Pollen">
    <meta data-react-helmet="true" name="twitter:description" content="My personal site, a web blog about software development, functional programming, and programming languages.">

    <title>Migrating my blog to Pollen</title>
    <link rel="stylesheet" type="text/css" href="/styles.css" />

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8GNFS4T3Y0"></script>
    <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());

     gtag('config', 'G-8GNFS4T3Y0');
    </script>
  </head>
<body class="lang-racket">
      <div class="centered-content-container">
        <header>
          <h1 class="my-name">Ryan Jung</h1>
          <ul class="nav-links">
            <li>
              <a href="/index.html">Home</a>
            </li>
            <li>
              <a href="/about.html">About</a>
            </li>
            <li>
              <a href="/thoughts">Thoughts</a>
            </li>
          </ul>
        </header>
        <main>
          <article><root><h1 id="migrating-my-blog-to-pollen">Migrating my blog to Pollen</h1><p>2022/04/28</p><p>I just moved my blog from Gatsby to Pollen. I wasn&rsquo;t happy with the GraphQL magic and JSX that I had to use in order to get a simple static website. 11ty seemed to do what I want, but I found writing HTML with Liquid and Nunjucks frustrating. You could automate a good amount of work with shortcodes but it was never fun to write.</p><p>I wanted a framework that would allow me to write custom tags that could expand into valid HTML when compiled. If I could actually understand how it works that would be great too. Ideally the project structure would look something like this:</p><pre><code>src/
  template.html
  index.html
  other-pages/
    index.html
    post.md
  style.css

-&gt;

build/
  index.html
  other-pages/
    index.html
    post.html
  style.css
...</code></pre><p>No crazy components, just a pre-processor that handles turning templated HTML and markdown into plain old HTML.</p><h2 id="enter-pollen">Enter Pollen</h2><p>Pollen is a tool designed by Matthew Butterick to produce high quality online books. It takes in Pollen markup files and spits out HTML (or CSS, PDFs, XML, LaTex, you name it).</p><p>You can evaluate arbitrary Racket expressions using <code>◊</code> Unlike most static site generators and templating tools, Pollen markup gives you the full power of a programming language &mdash; not some subset or an inflexible toy language.</p><pre class="brush: racket"><code>◊h1{Thoughts}

A collection of short blog posts about ...

◊(apply ul
  (map (compose li node-&gt;link) (children 'thoughts/index.html)))</code></pre><p>Coming from 11ty&rsquo;s built-in templating functions, this was <em>liberating</em>. I&rsquo;m not stuck with <code>titleCase</code>, <code>filter</code>, or dealing with exporting ugly Javscript template strings. I can write and import Racket functions that do <em>exactly</em> what I want as if it were any other program.</p><p>In fact, Pollen markup files are really just glorified Racket programs! The reader parses everything into an s-expression and converts it to HTML.</p><p>The file structure is plain simple. You have <code>whatever.html.pm</code> files that compile to <code>whatever.html</code> files under a build directory. Exactly what I wanted.</p><h2 id="deployment">Deployment</h2><p>I previously hosted my Gatsby website through Netlify. If I could stay on Netlify, it would sure make my life a lot simpler.</p><p>It turned out to be painful to build and deploy Pollen through Netlify; although in retrospect, a lot of that pain was due to user error.</p><p>I was able to use homebrew to install Racket, but <code>raco pkg install --auto pollen</code> was taking <em>forever</em>. We&rsquo;re talking 45 minutes just to install pollen and its dependencies.</p><p>I knew something was up. When I had previously attempted to download pollen in a Github Action (through the excellent setup-racket action) it only took a couple minutes.</p><p>I saw that my naive <code>raco pkg install</code> was downloading irrelevant dependencies and rendering scribble. Getting rid of the scribble rendering via <code>raco pkg install --no-docs  ...</code> cut my time in half down to about 20 minutes, but that was still ridiculously slow.</p><p>After finding a <a href="https://stackoverflow.com/questions/60484316/installing-racket-packages-without-installing-dr-racket">StackOverflow post</a>, I realized that I could just download a prebuilt binary with build dependencies stripped out. Turns out, that was the missing piece.</p><p>After pointing <code>raco</code> at the right catalogs and passing in the <code>--binary</code> flag, the entire build took less than three minutes.</p><h2 id="drawbacks">Drawbacks</h2><p>Pollen wasn&rsquo;t really built as a blogging tool, though. I still need to manually make sitemap, rss feed, and SEO tags. As with all website rewrites, I&rsquo;m a concerned that Google will nuke my SEO score into the ground, throwing <code>ryanjung.dev</code> into obscurity (not that I was ever not obscure).</p><p>But Pollen is really flexible. Like I said, its just a file pre-processor at heart so you can automate most of the files you need.</p><p>The one killer feature Pollen doesnt support is templates for templates. Right now you can only write templates in their source language.</p><p>(AFAIK, email me if you know a way to do either!)</p><h2 id="write-your-own-pollen-blog">Write your own Pollen blog!</h2><p>If you&rsquo;re scarred by other static site generation tools and get tingles from saying &ldquo;I built my website in Racket&rdquo;, then I highly reccommend Pollen.</p><p>If you need a template, all the source code for my website can be found <a href="https://github.com/rymaju/pollen-ryanjung.dev">here</a>.</p></root></article>
        </main>

        <footer>
          <p>

          <- <a href="/thoughts/howto-ta.html">HOWTO: Be a good teaching assistant (TA)</a>
          <span style="float:right;"><a href="/thoughts/links.html">Links</a> -></span>
          </p>
          <p>
            Built with <a href="https://docs.racket-lang.org/pollen/">Pollen</a> & <a href="https://racket-lang.org/">Racket</a>. See <a href="https://github.com/rymaju/pollen-ryanjung.dev/blob/main/src/thoughts/pollen.html.pmd">the source code for this page on Github</a>.
          </p>
          <p>
            <small>
              Last automatically built and deployed Saturday, May 6th, 2023.
            </small>
          </p>
        </footer>
</body>

</html>